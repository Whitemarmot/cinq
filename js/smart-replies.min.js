"use strict";const CinqSmartReplies=function(){const e="cinq_smart_replies_enabled",t=[{category:"greeting_morning",patterns:[/\b(bonjour|bon matin|bonne journ[√©e]e)\b/i],priority:10,replies:["Bonjour ! ‚òÄÔ∏è","Hello ! Bonne journ√©e √† toi aussi !","Coucou, bien dormi ? üòä"]},{category:"greeting_evening",patterns:[/\b(bonsoir|bonne soir[√©e]e)\b/i],priority:10,replies:["Bonsoir ! üåô","Hey, bonne soir√©e !","Salut, tu vas bien ?"]},{category:"greeting_night",patterns:[/\b(bonne nuit|dors bien|fais de beaux r[√™e]ves)\b/i],priority:10,replies:["Bonne nuit ! üåôüí§","Dors bien ! √Ä demain üò¥","Fais de beaux r√™ves ‚ú®"]},{category:"greeting_casual",patterns:[/^(salut|coucou|hey|yo|hello|hi)\b/i],priority:8,replies:["Hey ! üëã","Salut, √ßa va ?","Coucou ! üòä"]},{category:"greeting_whatsup",patterns:[/\b(quoi de (neuf|beau|9)|wesh|[√ßc]a (va|dit|roule))\b/i],priority:9,replies:["√áa va tranquille, et toi ?","La forme ! Et de ton c√¥t√© ?","Rien de sp√©cial, et toi quoi de neuf ?"]},{category:"how_are_you",patterns:[/\b(comment [√ßc]a va|[√ßc]a va|tu vas bien|la forme)\s*\??\s*$/i,/\b([√ßc]a va|t[ue] vas bien)\b.*\?/i],priority:15,replies:["√áa va bien, merci ! Et toi ? üòä","Super ! La forme, et toi ?","Tranquille ! Et de ton c√¥t√© ?"]},{category:"how_are_you_negative",patterns:[/\b(pas tr[√®e]s bien|bof|moyen|pas top|pas ouf)\b/i],priority:12,replies:["Oh, qu'est-ce qui se passe ? üíô","Je suis l√† si tu veux en parler","Courage, √ßa va aller ‚ù§Ô∏è"]},{category:"what_doing",patterns:[/\b(tu fais quoi|tu fais koi|quoi de pr√©vu|qu'?est.?ce (que )?tu fais)\b/i,/\b(t['']?es o[√πu]|tu es o[√πu]|t'es o√π)\b/i],priority:12,replies:["Pas grand chose, pourquoi ?","Je me d√©tends un peu, et toi ?","Rien de sp√©cial, tu voulais faire quelque chose ?"]},{category:"availability",patterns:[/\b(tu es (libre|dispo)|t['']?es (libre|dispo)|on se voit|on fait quoi)\b/i,/\b(disponible|rdv|rendez-vous)\b/i],priority:14,replies:["Oui, je suis dispo ! üëç","√áa d√©pend quand, tu proposes quoi ?","Peut-√™tre, c'est pour quoi ?"]},{category:"when_question",patterns:[/\b(quand|[√†a] quelle heure|quel jour|c'?est (pour )?quand)\b.*\?/i],priority:11,replies:["Je regarde et je te dis !","√áa d√©pend, tu as une pr√©f√©rence ?","Dis-moi ce qui t'arrange"]},{category:"good_news",patterns:[/\b(super|g√©nial|trop bien|excellent|parfait|incroyable|magnifique)\b/i,/\b(j'?ai (r√©ussi|eu|gagn√©)|c'?est fait)\b/i],priority:10,replies:["Trop bien ! üéâ","G√©nial, je suis content(e) pour toi !","Super nouvelle ! üôå"]},{category:"excitement",patterns:[/\b(j['']?ai h[√¢a]te|trop press√©|vivement|impatient)\b/i,/(!{2,}|üéâ|ü•≥|üòç)/],priority:8,replies:["Moi aussi j'ai h√¢te ! üéâ","√áa va √™tre g√©nial !","Trop bien, vivement ! üòä"]},{category:"lol",patterns:[/\b(lol|mdr|ptdr|haha|hihi|üòÇ|ü§£|üòÜ)\b/i,/(haha|hihi|ho+ho+|ah+ah+)/i],priority:7,replies:["üòÇ","Haha trop dr√¥le !","ü§£ü§£"]},{category:"sad",patterns:[/\b(triste|d[√©e]prim[√©e]|pas (le |la )?moral|mal|malheureux)\b/i,/\b(je (vais|suis) pas bien|dur|difficile|compliqu[√©e])\b/i,/(üò¢|üò≠|üíî|üòî|üòû)/],priority:15,replies:["Je suis l√† pour toi ‚ù§Ô∏è","Courage, √ßa va aller üíô","Tu veux en parler ? Je suis l√†"]},{category:"stressed",patterns:[/\b(stress[√©e]|anxieux|anxi[√©e]t[√©e]|paniqu|nerv(eux|euse)|tendu)\b/i,/\b(trop de (travail|boulot|choses)|d[√©e]bord[√©e]|submerg[√©e])\b/i],priority:14,replies:["Respire, tu vas g√©rer ! üí™","Je suis l√† si tu as besoin","Courage, une chose √† la fois ‚ù§Ô∏è"]},{category:"tired",patterns:[/\b(fatigu[√©e]|crev[√©e]|[√©e]puis[√©e]|mort|dead|ko|naze)\b/i,/\b(besoin de (dormir|repos)|envie de rien)\b/i],priority:11,replies:["Repose-toi bien ! üò¥","Fais une pause, tu le m√©rites","Prends soin de toi ‚ù§Ô∏è"]},{category:"angry",patterns:[/\b([√©e]nerv[√©e]|en col[√®e]re|furieux|ral|agac[√©e]|sao[√ªu]l[√©e])\b/i,/\b(pu[t]+ain|merde|fait (chier|iech))\b/i],priority:12,replies:["Qu'est-ce qui s'est pass√© ?","Je comprends, c'est frustrant","Tu veux en parler ? üíô"]},{category:"thanks",patterns:[/\b(merci|thanks|thx|mrc)\b/i],priority:12,replies:["De rien ! üòä","Avec plaisir !","Pas de souci üëç"]},{category:"sorry",patterns:[/\b(d[√©e]sol[√©e]|pardon|excuse|sry|sorry)\b/i],priority:11,replies:["T'inqui√®te, pas de souci !","C'est rien, t'en fais pas üòä","Pas grave !"]},{category:"please",patterns:[/\b(s'?il (te|vous) pla[i√Æ]t|stp|svp|please|pls)\b/i],priority:8,replies:["Bien s√ªr ! üëç","Oui, pas de probl√®me","Je m'en occupe !"]},{category:"agreement",patterns:[/^(ok|okay|d['']?accord|oui|ouais|yep|yup|√ßa marche|nickel)\.?!?$/i],priority:6,replies:["üëç","Super !","Parfait !"]},{category:"disagreement",patterns:[/^(non|nan|nope|pas (vraiment|trop)|bof)\.?!?$/i],priority:6,replies:["D'accord, pas de souci","OK, une autre fois alors ?","Comme tu veux üëç"]},{category:"birthday",patterns:[/\b(anniversaire|birthday|anniv)\b/i],priority:15,replies:["Joyeux anniversaire ! üéÇüéâ","Bon anniv ! üéà Plein de bonheur !","Happy birthday ! üéÅ‚ú®"]},{category:"congratulations",patterns:[/\b(f[√©e]licitations|bravo|congrats|chapeau)\b/i,/\b(j['']?ai (r[√©e]ussi|eu|d[√©e]croch[√©e]))\b/i],priority:13,replies:["F√©licitations ! üéâ","Bravo, tu le m√©rites ! üëè","Trop fier(e) de toi ! üåü"]},{category:"food_drink",patterns:[/\b(manger|resto|restaurant|boire|caf[√©e]|verre|ap[√©e]ro)\b/i,/\b(tu veux|on va|on fait)\b.*\b(manger|boire)\b/i],priority:10,replies:["Bonne id√©e ! üçΩÔ∏è","Je suis partant(e) !","Avec plaisir, quand ?"]},{category:"movie_activity",patterns:[/\b(film|cin[√©e]|s[√©e]rie|netflix|regarder)\b/i,/\b(sortir|balade|promenade|activit[√©e])\b/i],priority:9,replies:["Je suis chaud(e) ! üé¨","Bonne id√©e ! Tu proposes quoi ?","Oui, √ßa me dit !"]},{category:"love",patterns:[/\b(je t['']?aime|love you|bisou|c√¢lin|‚ù§Ô∏è|üíï|üíó|üòò)\b/i,/\b(tu me manques|h√¢te de te voir)\b/i],priority:16,replies:["‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è","Moi aussi je t'aime ! üíï","Tu me manques aussi üòò"]},{category:"thinking_of_you",patterns:[/\b(je pense [√†a] toi|dans mes pens[√©e]es|tu me manques)\b/i],priority:14,replies:["C'est trop mignon ü•∞","Moi aussi je pense √† toi !","üíï"]},{category:"help",patterns:[/\b(aide|help|besoin (de |d[''])aide|tu peux m['']?aider)\b/i,/\b(saurais|pourrais|peux).*(aider|faire)\b/i],priority:13,replies:["Bien s√ªr, dis-moi !","Je t'√©coute, qu'est-ce qu'il te faut ?","Je peux essayer ! C'est quoi ?"]},{category:"question_what",patterns:[/\b(c['']?est quoi|qu['']?est.?ce que?|pourquoi|comment)\b.*\?/i],priority:7,replies:["Bonne question !","Hmm, laisse-moi r√©fl√©chir...","Je sais pas trop, et toi ?"]},{category:"ping_received",patterns:[/^üí´$/],priority:20,replies:["üí´ Ping re√ßu !","Hey ! Tu voulais me dire quelque chose ?","Coucou, tout va bien ? üëã"]}];let r=!0,n=[],i=null;function a(e){if(!e||"string"!=typeof e)return[];const r=e.trim().toLowerCase(),n=[];return t.forEach(e=>{e.patterns.some(e=>e.test(r))&&n.push({category:e.category,priority:e.priority,replies:e.replies})}),n.sort((e,t)=>t.priority-e.priority),n}function s(e){const t=a(e);if(0===t.length)return[];const r=new Set;for(const e of t){const t=[...e.replies].sort(()=>Math.random()-.5);for(const e of t)r.size<3&&r.add(e);if(r.size>=3)break}return Array.from(r)}function o(e,t){if(p(),!r||!e||0===e.length)return void(n=[]);n=e;const a=document.createElement("div");a.id="smart-replies-container",a.className="smart-replies-container",a.setAttribute("role","listbox"),a.setAttribute("aria-label","Suggestions de r√©ponses"),a.innerHTML=`\n            <div class="smart-replies-header">\n                <span class="smart-replies-icon">üí°</span>\n                <span class="smart-replies-label">R√©ponses sugg√©r√©es</span>\n            </div>\n            <div class="smart-replies-list" role="list">\n                ${e.map((e,t)=>`\n                    <button \n                        class="smart-reply-btn" \n                        data-reply="${c(e)}"\n                        data-index="${t}"\n                        role="option"\n                        tabindex="${0===t?"0":"-1"}"\n                    >\n                        ${c(e)}\n                    </button>\n                `).join("")}\n            </div>\n        `,t&&(t.insertBefore(a,t.firstChild),i=a,a.querySelectorAll(".smart-reply-btn").forEach(e=>{e.addEventListener("click",()=>{l(e.dataset.reply)})}),a.addEventListener("keydown",u))}function p(){const e=document.getElementById("smart-replies-container");e&&e.remove(),i=null,n=[]}function l(e){const t=document.getElementById("message-input")||document.getElementById("chat-input");t&&(t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0})),t.focus(),t.setSelectionRange(e.length,e.length),p(),"function"==typeof showToast&&showToast("R√©ponse sugg√©r√©e !","success"))}function u(e){const t=i?.querySelectorAll(".smart-reply-btn");if(!t||0===t.length)return;const r=document.activeElement,n=Array.from(t).indexOf(r);switch(e.key){case"ArrowRight":case"ArrowDown":e.preventDefault();const i=t[(n+1)%t.length];i?.focus();break;case"ArrowLeft":case"ArrowUp":e.preventDefault();const a=t[(n-1+t.length)%t.length];a?.focus();break;case"Escape":e.preventDefault(),p(),document.getElementById("message-input")?.focus();break;case"Enter":case" ":e.preventDefault(),r?.dataset?.reply&&l(r.dataset.reply)}}function c(e){if(void 0!==window.Cinq&&window.Cinq.escapeHtml)return window.Cinq.escapeHtml(e);const t=document.createElement("div");return t.textContent=e,t.innerHTML}function d(){r=!0;try{localStorage.setItem(e,"true")}catch(e){}}function b(){r=!1,p();try{localStorage.setItem(e,"false")}catch(e){}}return{init:function(){try{"false"===localStorage.getItem(e)&&(r=!1)}catch(e){}document.addEventListener("input",e=>{"message-input"!==e.target.id&&"chat-input"!==e.target.id||e.target.value.trim().length>0&&p()}),function(){if(document.getElementById("smart-replies-styles"))return;const e=document.createElement("style");e.id="smart-replies-styles",e.textContent="\n            .smart-replies-container {\n                padding: 12px 16px;\n                background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);\n                border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n                animation: smartRepliesSlideIn 0.2s ease-out;\n            }\n            \n            @keyframes smartRepliesSlideIn {\n                from {\n                    opacity: 0;\n                    transform: translateY(-8px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateY(0);\n                }\n            }\n            \n            .smart-replies-header {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                margin-bottom: 10px;\n            }\n            \n            .smart-replies-icon {\n                font-size: 14px;\n            }\n            \n            .smart-replies-label {\n                font-size: 11px;\n                font-weight: 600;\n                text-transform: uppercase;\n                letter-spacing: 0.5px;\n                color: rgba(255, 255, 255, 0.5);\n            }\n            \n            .smart-replies-list {\n                display: flex;\n                flex-wrap: wrap;\n                gap: 8px;\n            }\n            \n            .smart-reply-btn {\n                display: inline-flex;\n                align-items: center;\n                padding: 8px 14px;\n                background: rgba(255, 255, 255, 0.08);\n                border: 1px solid rgba(255, 255, 255, 0.15);\n                border-radius: 20px;\n                color: rgba(255, 255, 255, 0.9);\n                font-size: 13px;\n                font-weight: 500;\n                cursor: pointer;\n                transition: all 0.15s ease;\n                white-space: nowrap;\n                max-width: 100%;\n                overflow: hidden;\n                text-overflow: ellipsis;\n            }\n            \n            .smart-reply-btn:hover {\n                background: rgba(99, 102, 241, 0.3);\n                border-color: rgba(99, 102, 241, 0.5);\n                transform: translateY(-1px);\n            }\n            \n            .smart-reply-btn:focus {\n                outline: none;\n                background: rgba(99, 102, 241, 0.4);\n                border-color: rgba(99, 102, 241, 0.6);\n                box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);\n            }\n            \n            .smart-reply-btn:active {\n                transform: translateY(0);\n            }\n            \n            /* Dark mode adjustments */\n            @media (prefers-color-scheme: light) {\n                .smart-replies-container {\n                    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.08) 100%);\n                    border-bottom-color: rgba(0, 0, 0, 0.1);\n                }\n                \n                .smart-replies-label {\n                    color: rgba(0, 0, 0, 0.5);\n                }\n                \n                .smart-reply-btn {\n                    background: rgba(99, 102, 241, 0.1);\n                    border-color: rgba(99, 102, 241, 0.2);\n                    color: #4338ca;\n                }\n                \n                .smart-reply-btn:hover {\n                    background: rgba(99, 102, 241, 0.2);\n                    border-color: rgba(99, 102, 241, 0.4);\n                }\n            }\n            \n            /* Mobile adjustments */\n            @media (max-width: 480px) {\n                .smart-replies-container {\n                    padding: 10px 12px;\n                }\n                \n                .smart-replies-list {\n                    gap: 6px;\n                }\n                \n                .smart-reply-btn {\n                    padding: 6px 12px;\n                    font-size: 12px;\n                }\n            }\n        ",document.head.appendChild(e)}(),console.log("[SmartReplies] Module initialized")},analyzeMessage:a,generateSuggestions:s,processMessages:function(e,t,n){if(!r||!e||0===e.length)return void p();const i=[...e].reverse().find(e=>!e.is_mine&&e.sender_id!==t);if(!i)return void p();if(i.is_ping){return void o(s("üí´"),n)}o(s(i.content),n)},render:o,hide:p,insertReply:l,enable:d,disable:b,toggle:function(){return r?b():d(),r},isActive:function(){return r},MAX_SUGGESTIONS:3,PATTERNS:t}}();"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>CinqSmartReplies.init()):CinqSmartReplies.init(),window.CinqSmartReplies=CinqSmartReplies;