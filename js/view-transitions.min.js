const ViewTransitions=function(){"use strict";const t=200,e=!1;let n=!1,o=!1,i=[];function r(t){try{return new URL(t,window.location.origin).origin===window.location.origin}catch{return!1}}async function a(e,n){return new Promise(n=>{document.body.classList.add("page-transitioning-out"),setTimeout(()=>{window.location.href=e,n()},t)})}async function s(t,o){if(n)return;n=!0;window.location.pathname;try{const e=document.startViewTransition(async()=>{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}`);const n=await e.text(),r=(new DOMParser).parseFromString(n,"text/html");document.title=r.title;r.querySelectorAll("meta[name], meta[property]").forEach(t=>{const e=t.getAttribute("name")||t.getAttribute("property"),n=document.querySelector(`meta[name="${e}"], meta[property="${e}"]`);n&&n.setAttribute("content",t.getAttribute("content")||"")});const a=r.body,s=document.querySelectorAll("script[data-persistent]");"back"===o&&document.documentElement.classList.add("back-transition"),document.body.innerHTML=a.innerHTML,document.body.className=a.className,s.forEach(t=>document.body.appendChild(t)),history.pushState({path:t},"",t),i.push(t),i.length>50&&i.shift(),c()});await e.finished,document.documentElement.classList.remove("back-transition")}catch(n){e&&console.error("[ViewTransitions] Error:",n),window.location.href=t}finally{n=!1}}function c(){window.dispatchEvent(new CustomEvent("page:loaded")),f(),"undefined"!=typeof CinqAnimations&&CinqAnimations.init&&CinqAnimations.init(),window.location.hash||window.scrollTo({top:0,behavior:"instant"});const t=document.querySelector('main, [role="main"]');t&&(t.setAttribute("tabindex","-1"),t.focus({preventScroll:!0}),t.removeAttribute("tabindex"))}function d(t){const e=t.target.closest("a");if(!e)return;const n=e.getAttribute("href");if(!n)return;if(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;if(!r(n))return;if(function(t){try{const e=new URL(t,window.location.origin);return e.pathname===window.location.pathname&&e.search===window.location.search}catch{return!0}}(n)&&n.includes("#"))return;if(e.classList.contains("no-transition")||e.hasAttribute("data-no-transition"))return;t.preventDefault();const c=function(t,e){const n=i.length>1&&i[i.length-2]===e,o=["/login","/register","/gift","/redeem"],r=o.some(t=>e.includes(t)),a=o.some(e=>t.includes(e));return n?"back":r?"modal":a?"modal-close":"forward"}(window.location.pathname,new URL(n,window.location.origin).pathname);o?s(n,c):a(n)}function u(t){if(!o)return;const e=window.location.href;document.startViewTransition(async()=>{try{const t=await fetch(e),n=await t.text(),o=(new DOMParser).parseFromString(n,"text/html");document.documentElement.classList.add("back-transition"),document.title=o.title,document.body.innerHTML=o.body.innerHTML,document.body.className=o.body.className,c()}catch(t){window.location.reload()}}).finished.then(()=>{document.documentElement.classList.remove("back-transition")})}const l=new Set;function m(t){if(l.has(t))return;if(!r(t))return;const n=document.createElement("link");n.rel="prefetch",n.href=t,n.as="document",document.head.appendChild(n),l.add(t),e&&console.log("[ViewTransitions] Prefetched:",t)}function w(t){const e=t.target.closest("a");if(!e)return;const n=e.getAttribute("href");n&&r(n)&&m(n)}function f(){document.removeEventListener("click",d),document.addEventListener("click",d),"ontouchstart"in window||(document.removeEventListener("mouseover",w),document.addEventListener("mouseover",w))}function h(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&e&&console.log("[ViewTransitions] Reduced motion preferred, using minimal transitions"),o="startViewTransition"in document,e&&console.log("[ViewTransitions] API supported:",o),f(),window.addEventListener("popstate",u),i.push(window.location.pathname),document.body.classList.add("view-transitions-ready"),e&&console.log("[ViewTransitions] Initialized")}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h(),{init:h,navigate:function(t,e={}){const n=e.transitionType||"forward";return o?s(t,n):a(t)},isSupported:()=>o,prefetch:m}}();"undefined"!=typeof module&&module.exports&&(module.exports=ViewTransitions);