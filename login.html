<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title data-i18n-title="auth.login">Connexion ‚Äî Cinq</title>
    
    <!-- SEO -->
    <meta name="description" content="Connecte-toi √† Cinq et retrouve tes 5 proches. L'anti-r√©seau social sans likes, sans algorithme.">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Canonical -->
    <link rel="canonical" href="https://cinq.app/login">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Connexion ‚Äî Cinq">
    <meta property="og:description" content="L'anti-r√©seau social. 5 proches, pas de likes.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cinq.app/login">
    <meta property="og:image" content="https://cinq.app/og-image.png">
    <meta property="og:site_name" content="Cinq">
    <meta property="og:locale" content="fr_FR">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <meta name="theme-color" content="#0e0e12" id="theme-color-meta">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-192x192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap"></noscript>
    
    <!-- Design System -->
    <link rel="stylesheet" href="/design/styles.min.css">
    <link rel="stylesheet" href="/css/mobile-responsive.min.css">
    <link rel="stylesheet" href="/css/a11y.min.css">
    
    <!-- Theme CSS for smooth transitions -->
    <link rel="stylesheet" href="/css/theme.css">
    
    <!-- Theme initialization (before body to prevent flash) -->
    <script>
        (function(){var h=document.documentElement,s=localStorage.getItem('cinq_theme'),p=s||'dark',t=p;if(p==='auto'){t=window.matchMedia&&window.matchMedia('(prefers-color-scheme:light)').matches?'light':'dark'}h.setAttribute('data-theme',t);h.setAttribute('data-theme-preference',p);h.classList.add('theme-loading');var m=document.getElementById('theme-color-meta');if(m)m.content=t==='light'?'#faf9f7':'#0e0e12';var a=localStorage.getItem('cinq_accent')||'indigo';h.setAttribute('data-accent',a)})();
        
        const THEMES = ['dark', 'light', 'auto'];
        function getSystemPref() { return window.matchMedia && window.matchMedia('(prefers-color-scheme:light)').matches ? 'light' : 'dark'; }
        function getEffective(p) { return p === 'auto' ? getSystemPref() : (p || 'dark'); }
        function toggleTheme() {
            var h = document.documentElement;
            var curr = localStorage.getItem('cinq_theme') || 'dark';
            var next = THEMES[(THEMES.indexOf(curr) + 1) % 3];
            var eff = getEffective(next);
            h.classList.add('theme-transitioning');
            h.setAttribute('data-theme', eff);
            h.setAttribute('data-theme-preference', next);
            localStorage.setItem('cinq_theme', next);
            var m = document.getElementById('theme-color-meta');
            if(m) m.content = eff === 'light' ? '#faf9f7' : '#0e0e12';
            setTimeout(function() { h.classList.remove('theme-transitioning'); }, 400);
        }
        // Remove loading class
        requestAnimationFrame(function() { requestAnimationFrame(function() { document.documentElement.classList.remove('theme-loading'); }); });
    </script>
    <style>
        /* ===== LAYOUT ===== */
        .login-container {
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-5);
            padding-bottom: calc(var(--space-5) + 60px);
        }
        
        @media (max-width: 380px) {
            .login-container {
                padding: var(--space-4);
                padding-bottom: calc(var(--space-4) + 70px);
            }
        }
        
        /* ===== CARD ===== */
        .login-card {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            width: 100%;
            max-width: 400px;
            position: relative;
            box-shadow: var(--shadow-xl);
            animation: card-enter 0.4s var(--ease-out-expo);
        }
        
        @keyframes card-enter {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* Gradient border glow on hover */
        .login-card::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: inherit;
            background: var(--cinq-gradient);
            opacity: 0;
            z-index: -1;
            transition: opacity 0.3s;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            padding: 1px;
        }
        
        .login-card:hover::before {
            opacity: 0.4;
        }
        
        /* Top highlight */
        .login-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: var(--space-6);
            right: var(--space-6);
            height: 1px;
            background: var(--glass-highlight);
            pointer-events: none;
        }
        
        /* ===== LOGO ===== */
        .login-logo {
            text-align: center;
            margin-bottom: var(--space-6);
        }
        
        .login-logo .five {
            font-family: var(--font-display);
            font-size: 4rem;
            font-weight: 700;
            background: var(--cinq-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 4px 12px var(--color-brand-glow));
            position: relative;
            display: inline-block;
            transition: transform 0.3s var(--ease-spring);
        }
        
        .login-logo .five:hover {
            transform: scale(1.05) rotate(-3deg);
        }
        
        /* Pentagon glow */
        .login-logo .five::before {
            content: '';
            position: absolute;
            inset: -30px;
            background: conic-gradient(
                from 0deg,
                rgba(255, 107, 74, 0.3) 0deg,
                rgba(255, 138, 106, 0.2) 72deg,
                rgba(251, 191, 36, 0.15) 144deg,
                rgba(167, 139, 250, 0.2) 216deg,
                rgba(255, 107, 74, 0.3) 288deg
            );
            clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
            opacity: 0.5;
            z-index: -1;
            filter: blur(20px);
            animation: pentagon-pulse 4s ease-in-out infinite;
        }
        
        @keyframes pentagon-pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
        }
        
        /* ===== TITLES ===== */
        .login-title {
            font-family: var(--font-display);
            font-size: var(--text-2xl);
            font-weight: 600;
            text-align: center;
            margin-bottom: var(--space-2);
            letter-spacing: -0.02em;
        }
        
        .login-subtitle {
            color: var(--color-text-muted);
            text-align: center;
            margin-bottom: var(--space-6);
            font-size: var(--text-sm);
        }
        
        /* ===== WELCOME BANNER ===== */
        .welcome-banner {
            background: var(--color-success-muted);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-5);
            text-align: center;
            color: var(--color-success);
            font-size: var(--text-sm);
            animation: banner-slide 0.4s var(--ease-out-expo);
        }
        
        @keyframes banner-slide {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== FORM ===== */
        .form-group {
            margin-bottom: var(--space-4);
        }
        
        .form-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: 500;
            margin-bottom: var(--space-2);
            color: var(--color-text-secondary);
        }
        
        .form-input {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            color: var(--color-text-primary);
            font-size: var(--text-base);
            transition: 
                border-color 0.2s,
                box-shadow 0.2s,
                background 0.2s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--color-brand);
            box-shadow: 0 0 0 3px var(--color-brand-muted);
            background: var(--color-bg-elevated);
        }
        
        .form-input::placeholder {
            color: var(--color-text-muted);
        }
        
        .form-input.error {
            border-color: var(--color-error);
            box-shadow: 0 0 0 3px var(--color-error-muted);
        }
        
        .form-input.success {
            border-color: var(--color-success);
        }
        
        /* Password field with toggle */
        .password-field {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            right: var(--space-3);
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--color-text-muted);
            cursor: pointer;
            padding: var(--space-1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }
        
        .password-toggle:hover {
            color: var(--color-text-primary);
        }
        
        .password-field .form-input {
            padding-right: var(--space-10);
        }
        
        /* ===== SUBMIT BUTTON ===== */
        .submit-btn {
            width: 100%;
            padding: var(--space-4);
            background: var(--cinq-gradient);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            font-family: var(--font-display);
            font-size: var(--text-base);
            font-weight: 600;
            cursor: pointer;
            margin-top: var(--space-5);
            transition: 
                transform 0.15s var(--ease-spring),
                box-shadow 0.2s,
                opacity 0.15s;
            box-shadow: var(--shadow-glow-sm);
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .submit-btn:hover:not(:disabled)::before {
            left: 100%;
        }
        
        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.01);
            box-shadow: var(--shadow-glow);
        }
        
        .submit-btn:active:not(:disabled) {
            transform: translateY(0) scale(0.98);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* ===== LOADING STATE ===== */
        .loading-spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: var(--space-2);
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ===== MESSAGES ===== */
        .message {
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-lg);
            margin-top: var(--space-4);
            font-size: var(--text-sm);
            display: flex;
            align-items: flex-start;
            gap: var(--space-2);
            animation: message-in 0.3s var(--ease-out-expo);
        }
        
        @keyframes message-in {
            from { opacity: 0; transform: translateY(-10px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .message.error {
            background: var(--color-error-muted);
            color: var(--color-error);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .message.success {
            background: var(--color-success-muted);
            color: var(--color-success);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        
        .message-icon {
            flex-shrink: 0;
            margin-top: 1px;
        }
        
        /* Field error message */
        .field-error {
            font-size: var(--text-xs);
            color: var(--color-error);
            margin-top: var(--space-1);
            display: flex;
            align-items: center;
            gap: var(--space-1);
            animation: field-error-in 0.2s ease-out;
        }
        
        @keyframes field-error-in {
            from { opacity: 0; transform: translateX(-5px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* ===== LINKS ===== */
        .forgot-link {
            display: block;
            text-align: right;
            font-size: var(--text-xs);
            color: var(--color-text-muted);
            margin-top: var(--space-2);
            transition: color 0.2s;
        }
        
        .forgot-link:hover {
            color: var(--color-brand);
        }
        
        .home-link {
            text-align: center;
            margin-top: var(--space-5);
            font-size: var(--text-sm);
            color: var(--color-text-muted);
        }
        
        .home-link a {
            color: var(--color-brand);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .home-link a:hover {
            color: var(--color-brand-hover);
            text-decoration: underline;
        }
        
        .register-link {
            text-align: center;
            margin-top: var(--space-4);
            padding-top: var(--space-4);
            border-top: 1px solid var(--color-border);
            font-size: var(--text-sm);
            color: var(--color-text-muted);
        }
        
        .register-link a {
            color: var(--color-brand);
            font-weight: 500;
            text-decoration: none;
        }
        
        .register-link a:hover {
            text-decoration: underline;
        }
        
        /* ===== THEME TOGGLE ===== */
        .theme-toggle {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: 
                background var(--transition-fast),
                border-color var(--transition-fast),
                transform 0.15s var(--ease-spring);
            overflow: hidden;
        }
        
        .theme-toggle:hover {
            background: var(--color-bg-elevated);
            border-color: var(--color-border-active);
            transform: scale(1.05);
        }
        
        .theme-toggle:active {
            transform: scale(0.95);
        }
        
        .theme-toggle-icon {
            position: absolute;
            transition: transform 0.4s var(--ease-spring), opacity 0.3s;
            color: var(--color-text-secondary);
        }
        
        .theme-toggle .icon-sun {
            transform: rotate(0) scale(1);
            opacity: 1;
        }
        
        .theme-toggle .icon-moon {
            transform: rotate(-90deg) scale(0.5);
            opacity: 0;
        }
        
        [data-theme="light"] .theme-toggle .icon-sun {
            transform: rotate(90deg) scale(0.5);
            opacity: 0;
        }
        
        [data-theme="light"] .theme-toggle .icon-moon {
            transform: rotate(0) scale(1);
            opacity: 1;
        }
        
        /* ===== BACKGROUND ELEMENTS ===== */
        .pentagon-pattern {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: -2;
            opacity: 0.02;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpolygon points='30,5 55,22 47,52 13,52 5,22' fill='none' stroke='%23ff6b4a' stroke-width='0.5'/%3E%3C/svg%3E");
            background-size: 60px 60px;
        }
        
        .gradient-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.15;
            pointer-events: none;
            z-index: -1;
        }
        
        .gradient-orb-1 {
            width: 400px;
            height: 400px;
            background: var(--color-brand);
            top: -100px;
            right: -100px;
        }
        
        .gradient-orb-2 {
            width: 300px;
            height: 300px;
            background: #a78bfa;
            bottom: -50px;
            left: -50px;
        }
        
        /* ===== FOOTER ===== */
        .auth-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: var(--space-3) var(--space-4);
            padding-bottom: max(var(--space-3), env(safe-area-inset-bottom, 0px));
            text-align: center;
            font-size: var(--text-xs);
            color: var(--color-text-muted);
            background: linear-gradient(to top, var(--color-bg-primary) 0%, var(--color-bg-primary) 80%, transparent 100%);
            z-index: 50;
        }
        
        .auth-footer nav {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-1);
        }
        
        .auth-footer a {
            color: var(--color-text-muted);
            padding: var(--space-2);
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            transition: color 0.2s;
        }
        
        .auth-footer a:hover {
            color: var(--color-text-secondary);
        }
        
        /* ===== REDUCED MOTION ===== */
        @media (prefers-reduced-motion: reduce) {
            .login-card,
            .welcome-banner,
            .message,
            .login-logo .five::before,
            .field-error {
                animation: none !important;
            }
            
            .submit-btn::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Skip Links - WCAG AAA Compliant -->
    <nav class="skip-links" aria-label="Liens d'√©vitement">
        <a href="#login-form" class="skip-link">Aller au formulaire de connexion</a>
        <a href="#main-content" class="skip-link">Aller au contenu principal</a>
    </nav>
    
    <!-- Live region for dynamic announcements -->
    <div id="sr-announce" class="sr-announce" aria-live="polite" aria-atomic="true"></div>
    
    <!-- Live region for form validation errors -->
    <div id="form-errors" class="sr-announce" aria-live="assertive" aria-atomic="true"></div>
    
    <div class="noise-overlay" aria-hidden="true"></div>
    
    <!-- Language Switcher & Theme Toggle -->
    <div style="position: fixed; top: var(--space-4); right: var(--space-4); z-index: 100; display: flex; gap: var(--space-2); align-items: center;">
        <div id="lang-switcher" style="display: flex; gap: 4px;">
            <button class="lang-btn" data-lang="fr" aria-label="Fran√ßais" style="padding: 6px 10px; background: var(--color-bg-tertiary); border: 1px solid var(--color-border); border-radius: var(--radius-md); cursor: pointer; font-size: 12px; font-weight: 500; color: var(--color-text-secondary); transition: all 0.2s;">FR</button>
            <button class="lang-btn" data-lang="en" aria-label="English" style="padding: 6px 10px; background: var(--color-bg-tertiary); border: 1px solid var(--color-border); border-radius: var(--radius-md); cursor: pointer; font-size: 12px; font-weight: 500; color: var(--color-text-secondary); transition: all 0.2s;">EN</button>
        </div>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Basculer mode clair/sombre">
            <svg class="icon-sun theme-toggle-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
            <svg class="icon-moon theme-toggle-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        </button>
    </div>
    <style>
        .lang-btn.active { background: var(--color-brand-muted) !important; border-color: var(--color-brand) !important; color: var(--color-brand) !important; }
        .lang-btn:hover { background: var(--color-bg-elevated); border-color: var(--color-border-active); }
    </style>
    <script>
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (window.i18n) {
                    i18n.setLanguage(btn.dataset.lang);
                    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                }
            });
        });
        // Set initial active state
        window.addEventListener('i18n:loaded', () => {
            const lang = i18n.getLang();
            document.querySelectorAll('.lang-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.lang === lang);
            });
        });
    </script>
    
    <!-- Pentagon pattern -->
    <div class="pentagon-pattern" aria-hidden="true"></div>
    
    <!-- Ambient orbs -->
    <div class="gradient-orb gradient-orb-1" aria-hidden="true"></div>
    <div class="gradient-orb gradient-orb-2" aria-hidden="true"></div>

    <main id="main-content">
        <div class="login-container">
            <div class="login-card">
                <div class="login-logo">
                    <span class="five" aria-hidden="true">5</span>
                </div>
                
                <h1 class="login-title">Te revoil√†</h1>
                <p class="login-subtitle">Tes 5 t'attendent</p>

                <div id="welcome-banner" class="welcome-banner" style="display: none;" role="status">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;" aria-hidden="true"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                    Bienvenue dans le cercle ! Connecte-toi pour d√©couvrir ton espace.
                </div>

                <form id="login-form" aria-label="Formulaire de connexion" novalidate>
                    <div class="form-group">
                        <label class="form-label" for="email">Email</label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            class="form-input" 
                            required 
                            autocomplete="email" 
                            aria-required="true"
                            placeholder="ton@email.com"
                            aria-describedby="email-error"
                        >
                        <div id="email-error" class="field-error" style="display: none;" role="alert"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="password">Mot de passe</label>
                        <div class="password-field">
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                class="form-input" 
                                required 
                                autocomplete="current-password" 
                                aria-required="true"
                                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                aria-describedby="password-error"
                            >
                            <button 
                                type="button" 
                                class="password-toggle" 
                                onclick="togglePassword()" 
                                aria-label="Afficher le mot de passe"
                                id="password-toggle-btn"
                            >
                                <svg id="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                                <svg id="eye-off-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                            </button>
                        </div>
                        <div id="password-error" class="field-error" style="display: none;" role="alert"></div>
                        <a href="/forgot-password.html" class="forgot-link">Mot de passe oubli√© ?</a>
                    </div>

                    <button type="submit" class="submit-btn" id="submit-btn" aria-label="Se connecter √† mon compte">
                        Se connecter
                    </button>

                    <div id="message" class="message" style="display: none;" role="alert" aria-live="polite"></div>
                </form>

                <div class="register-link">
                    Pas encore de compte ? <a href="/register.html">Cr√©er un compte</a>
                </div>

                <div class="home-link">
                    <a href="/" aria-label="Retour √† la page d'accueil">‚Üê Retour √† l'accueil</a>
                </div>
            </div>
        </div>
    </main>

    <script>
        const API_URL = '/api';
        let isPasswordVisible = false;

        // Check if just registered
        if (new URLSearchParams(window.location.search).get('registered')) {
            document.getElementById('welcome-banner').style.display = 'block';
        }

        // Check if already logged in
        if (localStorage.getItem('cinq_session')) {
            window.location.href = '/app.html';
        }

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const eyeIcon = document.getElementById('eye-icon');
            const eyeOffIcon = document.getElementById('eye-off-icon');
            const toggleBtn = document.getElementById('password-toggle-btn');
            
            isPasswordVisible = !isPasswordVisible;
            passwordInput.type = isPasswordVisible ? 'text' : 'password';
            eyeIcon.style.display = isPasswordVisible ? 'none' : 'block';
            eyeOffIcon.style.display = isPasswordVisible ? 'block' : 'none';
            toggleBtn.setAttribute('aria-label', isPasswordVisible ? 'Masquer le mot de passe' : 'Afficher le mot de passe');
        }

        function showFieldError(fieldId, message) {
            const errorEl = document.getElementById(`${fieldId}-error`);
            const inputEl = document.getElementById(fieldId);
            if (errorEl && inputEl) {
                errorEl.innerHTML = `<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg> ${message}`;
                errorEl.style.display = 'flex';
                inputEl.classList.add('error');
                inputEl.setAttribute('aria-invalid', 'true');
            }
        }

        function hideFieldError(fieldId) {
            const errorEl = document.getElementById(`${fieldId}-error`);
            const inputEl = document.getElementById(fieldId);
            if (errorEl && inputEl) {
                errorEl.style.display = 'none';
                inputEl.classList.remove('error');
                inputEl.removeAttribute('aria-invalid');
            }
        }

        function showMessage(text, type) {
            const msg = document.getElementById('message');
            const icon = type === 'error' 
                ? '<svg class="message-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>'
                : '<svg class="message-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>';
            
            msg.innerHTML = `${icon}<span>${text}</span>`;
            msg.className = `message ${type}`;
            msg.style.display = 'flex';
        }

        function hideMessage() {
            document.getElementById('message').style.display = 'none';
        }

        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Real-time validation
        document.getElementById('email').addEventListener('blur', function() {
            if (this.value && !validateEmail(this.value)) {
                showFieldError('email', window.i18n ? i18n.t('validation.emailInvalid') : 'Adresse email invalide');
            } else {
                hideFieldError('email');
            }
        });

        document.getElementById('email').addEventListener('input', function() {
            hideFieldError('email');
            hideMessage();
        });

        document.getElementById('password').addEventListener('input', function() {
            hideFieldError('password');
            hideMessage();
        });

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Reset errors
            hideFieldError('email');
            hideFieldError('password');
            hideMessage();

            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;

            // Validation
            let hasError = false;

            if (!email) {
                showFieldError('email', window.i18n ? i18n.t('validation.emailRequired') : 'L\'email est requis');
                hasError = true;
            } else if (!validateEmail(email)) {
                showFieldError('email', window.i18n ? i18n.t('validation.emailInvalid') : 'Adresse email invalide');
                hasError = true;
            }

            if (!password) {
                showFieldError('password', window.i18n ? i18n.t('validation.passwordRequired') : 'Le mot de passe est requis');
                hasError = true;
            }

            if (hasError) return;

            // Submit
            const btn = document.getElementById('submit-btn');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading-spinner"></span>Connexion...';

            try {
                const res = await fetch(`${API_URL}/auth?action=login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await res.json();

                if (!res.ok) {
                    // More specific error messages with i18n
                    let errorMessage = data.error || (window.i18n ? i18n.t('errors.loginError') : 'Erreur de connexion');
                    
                    if (res.status === 401) {
                        errorMessage = window.i18n ? i18n.t('errors.unauthorized') : 'Email ou mot de passe incorrect. V√©rifie tes identifiants.';
                    } else if (res.status === 429) {
                        errorMessage = window.i18n ? i18n.t('errors.tooManyAttempts') : 'Trop de tentatives. R√©essaie dans quelques minutes.';
                    } else if (res.status >= 500) {
                        errorMessage = window.i18n ? i18n.t('errors.server') : 'Probl√®me de serveur. R√©essaie plus tard.';
                    }
                    
                    throw new Error(errorMessage);
                }

                // Store session
                localStorage.setItem('cinq_session', JSON.stringify(data.session));
                localStorage.setItem('cinq_user', JSON.stringify(data.user));

                // Success feedback before redirect
                const successMsg = window.i18n ? i18n.t('auth.loginSuccess') : 'Connexion r√©ussie ! Redirection...';
                const connectedMsg = window.i18n ? i18n.t('auth.connected') : 'Connect√© !';
                showMessage(successMsg, 'success');
                btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>' + connectedMsg;

                // Redirect to app
                setTimeout(() => {
                    window.location.href = '/app.html';
                }, 500);

            } catch (err) {
                showMessage(err.message, 'error');
                btn.disabled = false;
                btn.textContent = 'Se connecter';
                
                // Shake animation on error
                btn.style.animation = 'none';
                btn.offsetHeight; // Trigger reflow
                btn.style.animation = 'shake 0.5s ease-out';
            }
        });

        // Shake animation for error
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
                20%, 40%, 60%, 80% { transform: translateX(4px); }
            }
        `;
        document.head.appendChild(style);
    </script>

    <!-- Footer -->
    <footer class="auth-footer" role="contentinfo">
        <nav aria-label="Liens l√©gaux">
            <a href="/privacy.html">Confidentialit√©</a>
            <span aria-hidden="true" style="opacity: 0.5;">¬∑</span>
            <a href="/terms.html">CGU</a>
            <span aria-hidden="true" style="opacity: 0.5;">¬∑</span>
            <span style="padding: var(--space-2);">¬© 2025 Cinq</span>
        </nav>
    </footer>
    
    <!-- i18n -->
    <script defer src="/js/i18n.js"></script>
    <script>
        // Update texts on language change
        window.addEventListener('i18n:loaded', updateTexts);
        window.addEventListener('i18n:changed', updateTexts);
        
        function updateTexts() {
            document.title = i18n.t('auth.login') + ' ‚Äî Cinq';
            document.querySelector('.login-title').textContent = i18n.t('auth.loginTitle');
            document.querySelector('.login-subtitle').textContent = i18n.t('auth.loginSubtitle');
            document.querySelector('.skip-link').textContent = i18n.t('a11y.skipToLogin');
            document.querySelector('label[for="email"]').textContent = i18n.t('auth.email');
            document.querySelector('label[for="password"]').textContent = i18n.t('auth.password');
            document.querySelector('#email').placeholder = i18n.t('auth.emailPlaceholder');
            document.querySelector('#password').placeholder = i18n.t('auth.passwordPlaceholder');
            document.querySelector('.forgot-link').textContent = i18n.t('auth.forgotPassword');
            document.querySelector('#submit-btn').textContent = i18n.t('auth.loginButton');
            document.querySelector('.register-link').innerHTML = 
                i18n.t('auth.noAccount') + ' <a href="/register.html">' + i18n.t('auth.register') + '</a>';
            document.querySelector('.home-link a').textContent = '‚Üê ' + i18n.t('nav.backToHome');
            document.querySelector('.auth-footer a[href="/privacy.html"]').textContent = i18n.t('footer.privacy');
            document.querySelector('.auth-footer a[href="/terms.html"]').textContent = i18n.t('footer.terms');
            document.querySelector('.theme-toggle').setAttribute('aria-label', i18n.t('a11y.toggleTheme'));
            
            const welcomeBanner = document.getElementById('welcome-banner');
            if (welcomeBanner) {
                const svg = welcomeBanner.querySelector('svg').outerHTML;
                welcomeBanner.innerHTML = svg + ' ' + i18n.t('auth.welcomeBanner');
            }
        }
    </script>
    
    <!-- PWA Install Prompt -->
    <script src="/pwa-install.js" defer></script>
    <!-- Easter Eggs ü•ö -->
    <script src="/js/easter-eggs.min.js" defer></script>
</body>
</html>
